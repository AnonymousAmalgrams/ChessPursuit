function J(){this.B=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01),a=this.b+this.c+this.e,.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}var W=new function(){this.A=new J;var a,b,c,d,e,f,g,h,i,j,k,l;this.reset=function(){var a=this.A;d=100/(a.f*a.f+.001),e=100/(a.g*a.g+.001),f=1-a.h*a.h*a.h*.01,g=-a.i*a.i*a.i*1e-6,a.a||(k=.5-a.n/2,l=5e-5*-a.o),h=1+a.l*a.l*(0<a.l?-.9:10),i=0,j=1==a.m?0:(1-a.m)*(1-a.m)*2e4+32},this.D=function(){this.reset();var d=this.A;return a=d.b*d.b*1e5,b=d.c*d.c*1e5,c=d.e*d.e*1e5+12,3*((a+b+c)/3|0)},this.C=function(m,n){var o=this.A,p=1!=o.s||o.v,q=o.v*o.v*.1,r=1+3e-4*o.w,s=o.s*o.s*o.s*.1,t=1+1e-4*o.t,u=1!=o.s,v=o.x*o.x,w=o.g,x=o.q||o.r,y=o.r*o.r*o.r*.2,z=o.q*o.q*(0>o.q?-1020:1020),A=o.p?((1-o.p)*(1-o.p)*2e4|0)+32:0,B=o.d,C=o.j/2,D=o.k*o.k*.01,E=o.a,F=a,G=1/a,H=1/b,I=1/c,o=5/(1+o.u*o.u*20)*(.01+s);o>.8&&(o=.8);for(var J,K,L,M,N,o=1-o,O=!1,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=Array(1024),$=Array(32),_=Z.length;_--;)Z[_]=0;for(_=$.length;_--;)$[_]=2*Math.random()-1;for(_=0;n>_;_++){if(O)return _;if(A&&++X>=A&&(X=0,this.reset()),j&&++i>=j&&(j=0,d*=h),f+=g,d*=f,d>e&&(d=e,w>0&&(O=!0)),K=d,C>0&&(Y+=D,K*=1+Math.sin(Y)*C),K|=0,8>K&&(K=8),E||(k+=l,0>k?k=0:k>.5&&(k=.5)),++Q>F)switch(Q=0,++P){case 1:F=b;break;case 2:F=c}switch(P){case 0:R=Q*G;break;case 1:R=1+2*(1-Q*H)*B;break;case 2:R=1-Q*I;break;case 3:R=0,O=!0}x&&(z+=y,L=0|z,0>L?L=-L:L>1023&&(L=1023)),p&&r&&(q*=r,1e-5>q?q=1e-5:q>.1&&(q=.1)),N=0;for(var ab=8;ab--;){if(V++,V>=K&&(V%=K,3==E))for(J=$.length;J--;)$[J]=2*Math.random()-1;switch(E){case 0:M=k>V/K?.5:-.5;break;case 1:M=1-V/K*2;break;case 2:M=V/K,M=6.28318531*(M>.5?M-1:M),M=1.27323954*M+.405284735*M*M*(0>M?1:-1),M=.225*((0>M?-1:1)*M*M-M)+M;break;case 3:M=$[Math.abs(32*V/K|0)]}p&&(J=U,s*=t,0>s?s=0:s>.1&&(s=.1),u?(T+=(M-U)*s,T*=o):(U=M,T=0),U+=T,S+=U-J,M=S*=1-q),x&&(Z[W%1024]=M,M+=Z[(W-L+1024)%1024],W++),N+=M}N=.125*N*R*v,m[_]=N>=1?32767:-1>=N?-32768:32767*N|0}return n}};window.jsfxr=function(a){W.A.B(a);var b=W.D();a=new Uint8Array(4*((b+1)/2|0)+44);var b=2*W.C(new Uint16Array(a.buffer,44),b),c=new Uint32Array(a.buffer,0,44);c[0]=1179011410,c[1]=b+36,c[2]=1163280727,c[3]=544501094,c[4]=16,c[5]=65537,c[6]=44100,c[7]=88200,c[8]=1048578,c[9]=1635017060,c[10]=b;for(var b=b+44,c=0,d="data:audio/wav;base64,";b>c;c+=3)var e=a[c]<<16|a[c+1]<<8|a[c+2],d=d+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&e]);return d};var aa;!function(){function a(){this.sounds={}}a.prototype.add=function(a,b,c){this.sounds[a]=[],c.forEach(function(c,d){this.sounds[a].push({tick:0,count:b,pool:[]});for(var e=0;b>e;e++){var f=new Audio;f.src=jsfxr(c),this.sounds[a][d].pool.push(f)}},this)},a.prototype.play=function(a){var b=this.sounds[a],c=b.length>1?b[Math.floor(Math.random()*b.length)]:b[0];c.pool[c.tick].play(),c.tick<c.count-1?c.tick++:c.tick=0},aa=new a,aa.add("start",1,[[0,.2,.13,.01,,.3328,,,,,,,,.0994,,,,,1,,,.1,,.5]]),aa.add("right",5,[[3,1,.3197,.7823,.2124,.1117,,.091,,,,,,,,.3901,.1061,-.0873,1,,,,,.5]]),aa.add("pad",1,[[0,,.0945,,.1582,.4416,,-.535,,,,,,.3856,,,,,1,,,.0896,,.5]]),aa.add("boost",1,[[0,,.2833,,.1918,.4914,,.2408,,,,,,.0182,,,,,1,,,,,.5]]),aa.add("ring",5,[[0,,.0177,.565,.2893,.4147,,,,,,.4159,.6958,,,,,,1,,,,,.5]]),aa.add("bumper",1,[[0,,.2389,,.2437,.5057,,.164,,,,,,.1032,,,,,1,,,,,.5]]),aa.add("hurt",1,[[0,,.2056,,.2341,.2899,,.3315,,,,,,.1817,,.6354,,,1,,,,,.5]]),aa.add("eat",1,[[0,,.3402,,.2772,.4978,,.1736,,.2589,.3885,,,.1153,,,,,1,,,,,.5]]),aa.add("die",1,[[3,,.296,.6924,.1761,.2478,,.0895,,,,-.6933,.8848,,,,,,1,,,,,.5]])}(),window.onload=function(){"use strict";function a(){A=C.innerWidth,B=C.innerHeight,N.width=J,N.height=J+I}function b(){E.appendChild(N),u(),q(),r(),c(),a(),h()}function c(){var a,b,c=d;for(bb=c(db,5,5),c(eb,6,4),a=0,b=0;100>b;b++)for(a=0;K>a;a++)c(eb,10+b,a)}function d(a,b,c){var d={shape:null,shapeId:a,row:b,col:c};return Z[b]||(Z[b]={}),Z[b][c]=d,d}function e(){if(1==hb.space&&(_=!_,console.log("debug toggle anim: ",_),_&&(T=Date.now(),h())),!(0>=$||bb.anim)){var a=0,b=0;ib||((hb.down==fb||0===hb.down)&&(b=-1),(hb.up==fb||0===hb.up)&&(b=1),(hb.left==fb||0===hb.left)&&(a=-1),(hb.right==fb||0===hb.right)&&(a=1),(a||b)&&(a?(hb.up<=fb&&hb.up>0&&(b=1),hb.down<=fb&&hb.down>0&&(b=-1)):(hb.left<=fb&&hb.left>0&&(a=-1),hb.right<=fb&&hb.right>0&&(a=1)),f(bb.row+b,bb.col+a),ib=!0));var c;if(ib){var d=!0;for(c in Db)if(Db[c]){d=!1;break}ib=!d}for(c in hb)hb[c]>=1?hb[c]++:hb[c]>gb&&hb[c]--;if(!bb.anim&&jb.x>0&&jb.x<J&&jb.y>I&&jb.y<J+I){var e=jb.x/J,g=(jb.y-I)/J;n(e,g),lb=F.floor(n.res.x*K),kb=F.floor(n.res.y*K+X),a=lb-bb.col,b=kb-bb.row,a>1?a=1:-1>a&&(a=-1),b>1?b=1:-1>b&&(b=-1),kb=bb.row+b,lb=bb.col+a,jb.left&&(a||b)&&(jb.left=!1,f(kb,lb))}else lb=-1,kb=-1}}function f(a,b){var c=bb.col,d=bb.row;0>b?b=0:b>=K&&(b=K-1);var e=F.floor(X),f=$-2;e>a?a=e:a>=f&&(a=f),(b!=c||a!=d)&&(Z[a][b]&&g(Z[a][b]),delete Z[d][c],bb.oldCol=c,bb.oldRow=d,bb.anim=!0,bb.animStartTime=Date.now(),bb.col=b,bb.row=a,Z[a][b]=bb)}function g(a){ab.push(a),a.removedTime=Date.now(),a.justRemoved=!0}function h(){window.stb&&stb(),V?hb.space&&(V=!1,b(),hb.space=!1):W?renderHomeScreen():(e(),i(),j()),window.ste&&ste(),_&&requestAnimationFrame(h)}function i(){var a=Date.now();T&&(X+=Y*(a-T)*U);var b=F.floor(X)+M;if(!T||b>$){for(var c,d,e,f=b-M-5;f>$-M-5;f--)if(c=Z[f]){for(e=!0,d=0;K>d;d++)c[d]&&t(c[d]);delete Z[f]}for(f=$+1;b>=f;f++)if(c=Z[f])for(e=!0,d=0;K>d;d++){var g=K/2;d%2===0?g+=d/2:g-=(d+1)/2,c[g]&&s(c[g])}else Z[f]=[];$=b}T=a}function j(){x(O),O.save(),O.translate(0,I),O.fillStyle=mb,O.beginPath(),O.rect(0,0,J,J),O.fill(),O.clip();var a,b,c,d=F.floor(X),e=-(X-F.floor(X)),f={},g={},h={},i={};for(a=-1;M>a;a++)for(b=0;K>b;b++)m(b/K,(a+e)/K,f),m(b/K,(a+1+e)/K,i),m((b+1)/K,(a+1+e)/K,h),m((b+1)/K,(a+e)/K,g),O.beginPath(),O.moveTo(f.x*J,f.y*J),O.lineTo(g.x*J,g.y*J),O.lineTo(h.x*J,h.y*J),O.lineTo(i.x*J,i.y*J),O.closePath(),O.lineWidth=1,O.fillStyle=-1!=kb&&-1!=lb&&a+d==kb&&b==lb?pb:(a+b+d)%2===0?nb:ob,O.fill();if(O.restore(),O.drawImage(R,0,0),bb.anim){var j=U*(Date.now()-bb.animStartTime)/cb;0>j||j>=1?bb.anim=!1:(j=F.sin(j*G*.5),k(bb.oldRow,bb.oldCol,sb),bb.opacity=j*bb.opacity+(1-j)*sb.opacity,bb.scale=j*bb.scale+(1-j)*sb.scale,bb.x=j*bb.x+(1-j)*sb.x,bb.y=j*bb.y+(1-j)*sb.y,l(bb))}for(var n,o=$-M-5;$>=o;o++){var p=Z[o];if(p)for(var q=0;K>q;q++)if(p[q]){var r=p[q];k(r.row,r.col,r),l(r),r.y>bb.y&&(!n||n.y>r.y)&&(n=r)}}n&&Ab.insertBefore(bb.shape,n.shape);var s=Date.now();for(a=0,c=ab.length;c>a;a++){var u=ab[a],v=(s-u.removedTime)/1e3;v>1?(t(u),ab[a]=ab[c-1],c--,a--,ab=ab.slice(0,c)):(u.justRemoved&&(u.justRemoved=!1,u.removedX=u.x,u.removedY=u.y),u.x=u.x<.5*J?u.removedX-v*J:u.removedX+v*J,u.y=u.removedY-F.sin(v*G)*J*.4,l(u))}}function k(a,b,c){m((b+.5)/K,(a-X+.5)/K);var d=.02,e=1;m.res.y<qb?e=0:m.res.y<rb&&(e=1-(d-m.res.y)/(rb-qb)),c.opacity=e,c.x=m.res.x*J,c.y=m.res.y*J+I,c.scale=m.res.scaleX}function l(a){a.shape.style.opacity=a.opacity,a.scale>0&&a.shape.setAttributeNS(null,"transform","scale("+a.scale+") translate("+a.x/a.scale+","+a.y/a.scale+")")}function m(a,b,c){return c=c||m.res,c.y=o(b,tb,ub,vb),c.scaleX=o(b,wb,xb,yb),c.scaleY=c.scaleX,c.x=(1-c.scaleX)/2+a*c.scaleX,c}function n(a,b,c){c=c||n.res,c.y=p(b,tb,ub,vb,!1);var d=o(c.y,wb,xb,yb);return c.x=(a-(1-d)/2)/d,c}function o(a,b,c,d){return b*a*a+c*a+d}function p(a,b,c,d,e){return e?(-c+F.sqrt(c*c-4*b*(d-a)))/(2*b):(-c-F.sqrt(c*c-4*b*(d-a)))/(2*b)}function q(){var a=Q,b=a.createLinearGradient(0,0,0,J),c="rgba(10,20,25,",d=")";b.addColorStop(0,c+0+d),b.addColorStop(.2,c+0+d),b.addColorStop(1,c+.5+d),a.fillStyle=b,a.fillRect(0,0,J,J),a.restore(),P.style.top=I+"px",P.style.pointerEvents="none",E.appendChild(P)}function r(){var a=S;a.clearRect(0,0,J,J),a.save(),a.fillStyle="#FF8601",a.beginPath(),a.rect(0,0,J,I),a.fill(),a.clip(),a.fillStyle="#FFE7CA";var b=J/4;a.beginPath(),a.arc(J/2,I+.3*b,b,0,G,!0),a.fill(),a.restore(),a.beginPath(),a.fillStyle="rgb(10,20,25)";for(var c=40,d=[0,.7,.1,.3,.2,1,.3,.5,.35,.8,.42,.5,.55,.9,.7,.45,.8,1.1,.88,.4,1,.8],e=0;e<d.length;e+=2){var f=d[e]*J,g=I-c*d[e+1];0===e?a.moveTo(f,g):a.lineTo(f,g)}a.lineTo(J,I),a.lineTo(0,I),a.fill(),a.restore(),a.save(),a.translate(0,I);var h=.02*J,i=a.createLinearGradient(0,0,0,h),j="rgba(10,20,25,",k=")";i.addColorStop(0,j+1+k),i.addColorStop(1,j+0+k),a.fillStyle=i,a.fillRect(0,0,J,h),a.restore()}function s(a){var b;if(Bb[a.shapeId]||(Bb[a.shapeId]=[]),b=Bb[a.shapeId].length?Bb[a.shapeId].pop():zb(a.shapeId),Ab.firstChild?Ab.insertBefore(b,Ab.firstChild):Ab.appendChild(b),a.shape)throw new Error;a.shape=b}function t(a){Bb[a.shapeId].push(a.shape),Ab.removeChild(a.shape),a.shape=null}function u(){function a(a,c){var d=D.createElementNS(k,"g");d.setAttributeNS(null,"id",a),d.appendChild(b());for(var e=0;e<c.length;e++){var f=c[e];f.setAttributeNS(null,"x",-L/2),f.setAttributeNS(null,"y",-L),d.appendChild(f)}return o.appendChild(d),d}function b(){var a=d(5,8,3.1,1.8);return i(a,"rgba(0,0,0,0.2)","none"),a}function c(a,b,c){var d=D.createElementNS(k,"circle");return j(d,{cx:h(a-p),cy:h(b-q),r:h(c)}),d}function d(a,b,c,d){var e=D.createElementNS(k,"ellipse");return j(e,{cx:h(a-p),cy:h(b-q),rx:h(c),ry:h(d)}),e}function e(a){var b=D.createElementNS(k,"path");return b.setAttributeNS(null,"d",f(a)),b}function f(a){for(var b="",c=0;c<a.length;c++){var d=a[c];"object"==typeof d&&(d=h(d[0]-p)+","+h(d[1]-q)),b+=d+" "}return b}function g(a,b){var c=D.createElementNS(k,"use");return j(c,b),c.setAttributeNS(l,"xlink:href","#"+a),c.setAttribute("xmlns:xlink",l),c}function h(a){return.1*F.round(L*a)}function i(a,b,c,d){var e={};return"undefined"!=typeof b&&(e.fill=b),"undefined"!=typeof c&&(e.stroke=c),"undefined"!=typeof d&&(e.strokeWidth=d),j(a,e),a}function j(a,b){if(b)for(var c in b)a.setAttributeNS(null,c,b[c]);return a}zb=g;var k="http://www.w3.org/2000/svg",l="http://www.w3.org/1999/xlink",m=J,n=J+I;Ab=D.createElementNS(k,"svg"),Ab.setAttribute("xmlns",k),Ab.setAttributeNS(null,"viewBox","0 0 "+m+" "+n),Ab.setAttributeNS(null,"width",m),Ab.setAttributeNS(null,"height",n),D.body.appendChild(Ab);var o=D.createElementNS(k,"defs");Ab.appendChild(o);var p=5,q=8,r="#eee",s="#555";i(a(eb,[e(["M",[2,8],"Q",[5,10],[8,8],"L",[5,3],"L",[2,8]]),c(5,3,2)]),r,s,0),i(a(db,[e(["M",[2,8],"Q",[5,10],[8,8],"L",[5,3],"L",[2,8]]),c(5,3,2)]),"#002","#333",0)}function v(a,b){var c=D.createElement("canvas");return c.width=a,c.height=b,c}function w(a){return a.getContext("2d")}function x(a){a.clearRect(0,0,A,B)}function y(a,b){b||(b=window.e);var c=b.keyCode;b.charCode&&!c&&(c=b.charCode);var d=Cb[c];d&&Db[d]!==a&&(Db[d]=a,a?hb[d]<1&&(console.log("keyDown",d),hb[d]=1):hb[d]>0&&(console.log("keyUp",d),hb[d]=0))}function z(a,b){var c,d;"which"in b?(c=3==b.which,d=2==b.which):"button"in b&&(c=2==b.button,d=1==b.button),c?jb.right=a:d?jb.middle=a:jb.left=a,D.onmousemove(b)}var A,B,C=window,D=C.document,E=D.body,F=C.Math,G=F.PI,H=(F.sqrt,F.random,1),I=100*H,J=400*H,K=8,L=J/K,M=2*K+3,N=v(J,J),O=w(N),P=v(J,J),Q=w(P),R=v(J,2*J),S=w(R);window.onresize=a();var T,U=.001,V=!1,W=!1,X=0,Y=1,Z={},$=-1,_=!0,ab=[],bb=null,cb=.05,db="kp",eb="p",fb=6,gb=-1,hb={left:-1,right:-1,up:-1,down:-1},ib=!1,jb={},kb=-1,lb=-1,mb="#193441",nb="#D1DBBD",ob="#3E606F",pb="#794",qb=-.02,rb=.02,sb={},tb=3/16,ub=-0.875,vb=1,wb=-2.5/16,xb=0,yb=1;m.res={},n.res={};var zb,Ab,Bb={},Cb={37:"left",65:"left",81:"left",38:"up",90:"up",87:"up",83:"down",40:"down",39:"right",68:"right",32:"space",27:"esc",13:"Enter"},Db={};D.onkeyup=function(a){y(!1,a),27==a.keyCode&&toggleHome(),32==a.keyCode&&W&&toggleHome()},D.onkeydown=function(a){y(!0,a)},D.onmousedown=function(a){z(!0,a)},D.onmouseup=function(a){z(!1,a)},D.onmousemove=function(a){jb.x=a.clientX,jb.y=a.clientY},D.oncontextmenu=function(){return!1},b()};