function J(){this.B=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01),a=this.b+this.c+this.e,.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}var W=new function(){this.A=new J;var a,b,c,d,e,f,g,h,i,j,k,l;this.reset=function(){var a=this.A;d=100/(a.f*a.f+.001),e=100/(a.g*a.g+.001),f=1-a.h*a.h*a.h*.01,g=-a.i*a.i*a.i*1e-6,a.a||(k=.5-a.n/2,l=5e-5*-a.o),h=1+a.l*a.l*(0<a.l?-.9:10),i=0,j=1==a.m?0:(1-a.m)*(1-a.m)*2e4+32},this.D=function(){this.reset();var d=this.A;return a=d.b*d.b*1e5,b=d.c*d.c*1e5,c=d.e*d.e*1e5+12,3*((a+b+c)/3|0)},this.C=function(m,n){var o=this.A,p=1!=o.s||o.v,q=o.v*o.v*.1,r=1+3e-4*o.w,s=o.s*o.s*o.s*.1,t=1+1e-4*o.t,u=1!=o.s,v=o.x*o.x,w=o.g,x=o.q||o.r,y=o.r*o.r*o.r*.2,z=o.q*o.q*(0>o.q?-1020:1020),A=o.p?((1-o.p)*(1-o.p)*2e4|0)+32:0,B=o.d,C=o.j/2,D=o.k*o.k*.01,E=o.a,F=a,G=1/a,H=1/b,I=1/c,o=5/(1+o.u*o.u*20)*(.01+s);o>.8&&(o=.8);for(var J,K,L,M,N,o=1-o,O=!1,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=Array(1024),$=Array(32),_=Z.length;_--;)Z[_]=0;for(_=$.length;_--;)$[_]=2*Math.random()-1;for(_=0;n>_;_++){if(O)return _;if(A&&++X>=A&&(X=0,this.reset()),j&&++i>=j&&(j=0,d*=h),f+=g,d*=f,d>e&&(d=e,w>0&&(O=!0)),K=d,C>0&&(Y+=D,K*=1+Math.sin(Y)*C),K|=0,8>K&&(K=8),E||(k+=l,0>k?k=0:k>.5&&(k=.5)),++Q>F)switch(Q=0,++P){case 1:F=b;break;case 2:F=c}switch(P){case 0:R=Q*G;break;case 1:R=1+2*(1-Q*H)*B;break;case 2:R=1-Q*I;break;case 3:R=0,O=!0}x&&(z+=y,L=0|z,0>L?L=-L:L>1023&&(L=1023)),p&&r&&(q*=r,1e-5>q?q=1e-5:q>.1&&(q=.1)),N=0;for(var ab=8;ab--;){if(V++,V>=K&&(V%=K,3==E))for(J=$.length;J--;)$[J]=2*Math.random()-1;switch(E){case 0:M=k>V/K?.5:-.5;break;case 1:M=1-V/K*2;break;case 2:M=V/K,M=6.28318531*(M>.5?M-1:M),M=1.27323954*M+.405284735*M*M*(0>M?1:-1),M=.225*((0>M?-1:1)*M*M-M)+M;break;case 3:M=$[Math.abs(32*V/K|0)]}p&&(J=U,s*=t,0>s?s=0:s>.1&&(s=.1),u?(T+=(M-U)*s,T*=o):(U=M,T=0),U+=T,S+=U-J,M=S*=1-q),x&&(Z[W%1024]=M,M+=Z[(W-L+1024)%1024],W++),N+=M}N=.125*N*R*v,m[_]=N>=1?32767:-1>=N?-32768:32767*N|0}return n}};window.jsfxr=function(a){W.A.B(a);var b=W.D();a=new Uint8Array(4*((b+1)/2|0)+44);var b=2*W.C(new Uint16Array(a.buffer,44),b),c=new Uint32Array(a.buffer,0,44);c[0]=1179011410,c[1]=b+36,c[2]=1163280727,c[3]=544501094,c[4]=16,c[5]=65537,c[6]=44100,c[7]=88200,c[8]=1048578,c[9]=1635017060,c[10]=b;for(var b=b+44,c=0,d="data:audio/wav;base64,";b>c;c+=3)var e=a[c]<<16|a[c+1]<<8|a[c+2],d=d+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&e]);return d};var aa;!function(){function a(){this.sounds={}}a.prototype.add=function(a,b,c){this.sounds[a]=[],c.forEach(function(c,d){this.sounds[a].push({tick:0,count:b,pool:[]});for(var e=0;b>e;e++){var f=new Audio;f.src=jsfxr(c),this.sounds[a][d].pool.push(f)}},this)},a.prototype.play=function(a){var b=this.sounds[a],c=b.length>1?b[Math.floor(Math.random()*b.length)]:b[0];c.pool[c.tick].play(),c.tick<c.count-1?c.tick++:c.tick=0},aa=new a,aa.add("start",1,[[0,.2,.13,.01,,.3328,,,,,,,,.0994,,,,,1,,,.1,,.5]]),aa.add("right",5,[[3,1,.3197,.7823,.2124,.1117,,.091,,,,,,,,.3901,.1061,-.0873,1,,,,,.5]]),aa.add("pad",1,[[0,,.0945,,.1582,.4416,,-.535,,,,,,.3856,,,,,1,,,.0896,,.5]]),aa.add("boost",1,[[0,,.2833,,.1918,.4914,,.2408,,,,,,.0182,,,,,1,,,,,.5]]),aa.add("ring",5,[[0,,.0177,.565,.2893,.4147,,,,,,.4159,.6958,,,,,,1,,,,,.5]]),aa.add("bumper",1,[[0,,.2389,,.2437,.5057,,.164,,,,,,.1032,,,,,1,,,,,.5]]),aa.add("hurt",1,[[0,,.2056,,.2341,.2899,,.3315,,,,,,.1817,,.6354,,,1,,,,,.5]]),aa.add("eat",1,[[0,,.3402,,.2772,.4978,,.1736,,.2589,.3885,,,.1153,,,,,1,,,,,.5]]),aa.add("die",1,[[3,,.296,.6924,.1761,.2478,,.0895,,,,-.6933,.8848,,,,,,1,,,,,.5]])}(),window.onload=function(){"use strict";function a(){t=v.innerWidth,u=v.innerHeight,G.width=C,G.height=C+B}function b(){n(),k(),c(),a(),f(),w.onmousedown=function(){S=!S,console.log("debug toggle anim: ",S)}}function c(){var a=d;a(T,5,5);for(var b=0;D>b;b++)a(T,1,b);a(T,25,5)}function d(a,b,c){var d={shape:null,shapeId:a,row:b,col:c};Q[b]||(Q[b]={}),Q[b][c]=d}function e(){}function f(){window.stb&&stb(),M?U.space&&(M=!1,b(),U.space=!1):N?renderHomeScreen():(e(),g(),h()),window.ste&&ste(),S&&requestAnimationFrame(f)}function g(){var a=Date.now();K&&(O+=P*(a-K)/1e3);var b=y.floor(O)+F;if(!K||b>R){for(var c,d,e,f=b-F-5;f>R-F-5;f--)if(c=Q[f]){for(e=!0,console.log("removing row",f),d=0;D>d;d++)c[d]&&m(c[d]);delete Q[f]}for(f=R+1;b>=f;f++)if(c=Q[f])for(e=!0,console.log("init row",f),d=0;D>d;d++)c[d]&&l(c[d]);e&&console.log("updated checkboard, topRowDisplayed",R,b,Q),R=b}K=a}function h(){q(H),H.save(),H.translate(0,B),H.fillStyle=W,H.beginPath(),H.rect(0,0,C,C),H.fill(),H.clip();for(var a=y.floor(O),b=-(O-y.floor(O)),c={},d={},e={},f={},g=-1;F>g;g++)for(var h=0;D>h;h++)i(h/D,(g+b)/D,c),i(h/D,(g+1+b)/D,f),i((h+1)/D,(g+1+b)/D,e),i((h+1)/D,(g+b)/D,d),H.beginPath(),H.moveTo(c.x*C,c.y*C),H.lineTo(d.x*C,d.y*C),H.lineTo(e.x*C,e.y*C),H.lineTo(f.x*C,f.y*C),H.closePath(),H.lineWidth=1,(g+h+a)%2===0?(H.fillStyle=X,H.fill()):(H.fillStyle=Y,H.fill());H.restore(),H.drawImage(I,0,0);for(var j={},k=R-F-5;R>=k;k++){var l=Q[k];if(l)for(var m=0;D>m;m++)if(l[m]){var n=l[m];i((n.col+.5)/D,(n.row-O+.5)/D,j);var o=j.x*C,p=j.y*C+B,r=+j.scaleX;n.shape.setAttributeNS(null,"transform","scale("+r+") translate("+o/r+","+p/r+")")}}}function i(a,b,c){c=c||{};var d=.5*b,e=j(d+.2,1.4,1);return b=(1-d)*d+d*(.75+.25*d),c.x=(1-e)/2+a*e,c.y=1-b,c.scaleX=e,c.scaleY=e,c}function j(a,b,c){return y.sqrt((1-a*a/(b*b))*c*c)}function k(){var a=J;a.clearRect(0,0,C,C),a.save(),a.save(),a.fillStyle="#FF8601",a.beginPath(),a.rect(0,0,C,B),a.fill(),a.clip(),a.fillStyle="#FFE7CA";var b=C/6;a.beginPath(),a.arc(C/2,B+.3*b,b,0,z,!0),a.fill(),a.restore(),a.beginPath(),a.fillStyle="rgb(10,20,25)";var c=40,d=10,e=0;a.moveTo(-c,B);for(var f=!0;C>e;){e+=(A()+.5)*c;var g=(f?.8+.2*A():.2+.2*A())*d;a.lineTo(e,B-g),f=!f}a.lineTo(C,B),a.lineTo(0,B),a.fill(),a.restore();var h=a.createLinearGradient(0,B,0,C),i="rgba(10,20,25,",j=")";h.addColorStop(0,i+.9+j),h.addColorStop(.01,i+0+j),h.addColorStop(.2,i+0+j),h.addColorStop(1,i+.5+j),a.fillStyle=h,a.fillRect(0,B,C,C),a.restore()}function l(a){var b;if(Z[a.shapeId]||(Z[a.shapeId]=[]),Z[a.shapeId].length?(b=Z[a.shapeId].pop(),b.style.display="block"):b=L(a.shapeId),a.shape)throw new Error;a.shape=b}function m(a){Z[a.shapeId].push(a.shape),a.shape.style.display="none",a.shape=null}function n(){function a(a,b){var c=w.createElementNS(i,"g");c.setAttributeNS(null,"id",a);for(var d=0;d<b.length;d++){var e=b[d];e.setAttributeNS(null,"x",-E/2),e.setAttributeNS(null,"y",-E),c.appendChild(e)}return n.appendChild(c),c}function b(a,b,c){var d=w.createElementNS(i,"circle");return h(d,{cx:f(a-o),cy:f(b-p),r:f(c)}),d}function c(a){var b=w.createElementNS(i,"path");return b.setAttributeNS(null,"d",d(a)),b}function d(a){for(var b="",c=0;c<a.length;c++){var d=a[c];"object"==typeof d&&(d=f(d[0]-o)+","+f(d[1]-p)),b+=d+" "}return b}function e(a,b){var c=w.createElementNS(i,"use");return h(c,b),c.setAttributeNS(j,"xlink:href","#"+a),c.setAttribute("xmlns:xlink",j),m.appendChild(c),c}function f(a){return.1*y.round(E*a)}function g(a,b,c,d){var e={};return b&&(e.fill=b),c&&(e.stroke=c,e.strokeWidth=d||1),h(a,e),a}function h(a,b){if(b)for(var c in b)a.setAttributeNS(null,c,b[c]);return a}L=e;var i="http://www.w3.org/2000/svg",j="http://www.w3.org/1999/xlink",k=C,l=C+B,m=w.createElementNS(i,"svg");m.setAttribute("xmlns",i),m.setAttributeNS(null,"viewBox","0 0 "+k+" "+l),m.setAttributeNS(null,"width",k),m.setAttributeNS(null,"height",l),w.body.appendChild(m);var n=w.createElementNS(i,"defs");m.appendChild(n);{var o=5,p=8;g(a(T,[c(["M",[2,8],"Q",[5,10],[8,8],"L",[5,3],"L",[2,8]]),b(5,3,2)]),"white","red",0)}}function o(a,b){var c=w.createElement("canvas");return c.width=a,c.height=b,c}function p(a){return a.getContext("2d")}function q(a){a.clearRect(0,0,t,u)}function r(a,b){b||(b=window.e);var c=b.keyCode;b.charCode&&!c&&(c=b.charCode),U[$[c]]=a}function s(a,b){var c,d;"which"in b?(c=3==b.which,d=2==b.which):"button"in b&&(c=2==b.button,d=1==b.button),c?V.right=a:d?V.middle=a:V.left=a,w.onmousemove(b)}var t,u,v=window,w=v.document,x=w.body,y=v.Math,z=y.PI,A=(y.sqrt,y.random),B=100,C=400,D=8,E=C/D,F=2*D+1,G=o(C,C),H=p(G),I=o(C,2*C),J=p(I);window.onresize=a(),x.appendChild(G);var K,L,M=!1,N=!1,O=0,P=2,Q={},R=0,S=!0,T="p",U={},V={},W="#193441",X="#D1DBBD",Y="#3E606F",Z={},$={37:"left",65:"left",81:"left",38:"up",90:"up",87:"up",83:"down",40:"down",39:"right",68:"right",32:"space",27:"esc",13:"Enter"};w.onkeyup=function(a){r(!1,a),27==a.keyCode&&toggleHome(),32==a.keyCode&&N&&toggleHome()},w.onkeydown=function(a){r(!0,a)},w.onmousedown=function(a){s(!0,a)},w.onmouseup=function(a){s(!1,a)},w.onmousemove=function(a){V.x=a.clientX,V.y=a.clientY},w.oncontextmenu=function(){return!1},b()};